---
title: "Lab"
author: "Julian Philip S. Quijano"
date: "2025-12-07"
output: 
  pdf_document: default
  md_document: default
editor_options: 
  markdown: 
    wrap: sentence
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r csv}
library(tidyverse)
library(car)  
library(rstatix)   
library(ggpubr)
df = read.csv("Alzheimers Mice Data.csv")
df$AD_Status <- as.factor(df$AD_Status)
df$Treatment <- as.factor(df$Treatment)
df
```

Assumption #1: You have one dependent variable that is measured at the continuous level.

Remark: The dependent variable is the Maze Errors (for Training Day and Memory Day) which can be measured continuously

Assumption #2: You have two independent variable that consists of three or more categorical, independent groups.

Remark: AD_Status and Treatment

Assumption #3: You should have independence of observations, which means that there is no relationship between the observations in each group of the independent variable or among the groups themselves.

Remark: Mouse performance is observed independently.

```{r Assumption 4 Training}
#Training Day
df %>%
  group_by(AD_Status, Treatment) %>%
  identify_outliers(Training)
  
ggplot(df, aes(x=Treatment, y=Training, fill=AD_Status)) +
  geom_boxplot(position=position_dodge(width=0.8)) +
  labs(title="Training Day Maze Errors by Treatment and AD Status",
       x="Drug Treatment",
       y="Maze Errors") +
  scale_fill_brewer(palette="Set1", name="AD Status") +
  theme_minimal()
```

```{r Assumption 4 Memory}
#Memory Day
df %>%
  group_by(AD_Status, Treatment) %>%
  identify_outliers(Memory)

ggplot(df, aes(x=Treatment, y=Memory, fill=AD_Status)) +
  geom_boxplot(position=position_dodge(width=0.8)) +
  labs(title="Memory Day Maze Errors by Treatment and AD Status",
       x="Drug Treatment",
       y="Maze Errors") +
  scale_fill_brewer(palette="Set1", name="AD Status") +
  theme_minimal()
```

Assumption #4: There should be no significant outliers in the three or more groups of your independent variable in terms of the dependent variable.

Remark: The results show that for Training Day, there were no significant outliers, and for Memory Day there was one outlier, but not significant.

```{r Normality}
# Training Day
df %>%
  group_by(AD_Status, Treatment) %>%
  shapiro_test(Training)

# Memory Day
df %>%
  group_by(AD_Status, Treatment) %>%
  shapiro_test(Memory)
```

Assumption #5: Your dependent variable should be approximately normally distributed for each group of the independent variable.

Remark: Given the P-values for all types are p \> 0.05, then the scores are approximately normally distributed for all groups.

```{r Levene}
leveneTest(Training ~ AD_Status*Treatment, data=df)
leveneTest(Memory ~ AD_Status*Treatment, data=df)
```

Assumption #6.
You have homogeneity of variances (i.e., the variance of the dependent variable is equal in each group of your independent variable).

Remark: Levene's Test for Training Day and Memory Day shows homogeneity with p values \> 0.05

```{r 2B-ANOVA}
# Training Day
anova_training = anova_test(
  data = df,
  dv = Training,
  between = c(AD_Status, Treatment),
  effect.size = "pes"
)
get_anova_table(anova_training)

# Memory Day
anova_memory = anova_test(
  data = df,
  dv = Memory,
  between = c(AD_Status, Treatment),
  effect.size = "pes"
)
cat('\n\n')
get_anova_table(anova_memory)
```

```{r Post-Hoc}
# Training Day
df %>%
  group_by(AD_Status) %>%
  pairwise_t_test(
    Training ~ Treatment,
    p.adjust.method = "holm"
  )

# Memory Day
df %>%
  group_by(AD_Status) %>%
  pairwise_t_test(
    Memory ~ Treatment,
    p.adjust.method = "holm"
  )
```

### Compare the training day errors based on drug treatments and AD status.

There was no significant main effect of AD status on Training Day errors, F(1, 32) = 1.216, p = .278, eta² = .037. This indicates that, on average, transgenic and wild-type mice did not differ significantly in errors during training.

There was a significant main effect of Drug Treatment, F(3, 32) = 3.789, p = .020, eta² = .262, indicating that the number of errors differed depending on which drug the mice received.

The interaction between AD status and Drug Treatment was not significant, F(3, 32) = 1.216, p = .320, eta² = .102, suggesting that the effect of the drug was similar for transgenic and wild-type mice.

Some drug pairs showed significant differences within AD groups, e.g., Drug 1 vs Drug 2 in AD group 1, p = .0119.

These differences suggest that certain drugs improved performance during training for some groups, but AD status did not significantly modify the effect.

Finally, Training performance was mostly influenced by the drug administered, not by whether the mice were transgenic or wild-type. No interaction effect means that drug effects were consistent across AD 


### Compare the memory day errors based on drug treatments and AD status.

There was a significant main effect of AD status, F(1, 32) = 75.313, p < .001, eta² = .702. Transgenic mice made more errors than wild-type mice, showing poorer memory performance.

There was no significant main effect of Drug Treatment, F(3, 32) = 1.920, p = .146, eta² = .153, suggesting that overall, the type of drug did not significantly affect memory errors.

The interaction between AD status and Drug Treatment was not significant, F(3, 32) = 1.151, p = .344, eta² = .097, indicating that the effect of drug treatment was similar across AD statuses.

No significant pairwise differences between treatments were observed after Holm correction, consistent with the non-significant main effect of Drug Treatment.

Finally, Memory performance was primarily influenced by AD status, with transgenic mice performing worse. Drug treatment did not significantly improve memory, and the effect of drugs did not differ between transgenic and wild-type mice.

Github Link: https://github.com/SylTana/APM1111-QUIJANO-JULIAN_PHILIP-Statistical-Theory-/tree/main/SA2